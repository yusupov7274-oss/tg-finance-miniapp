# üîë –î–æ–±–∞–≤–ª–µ–Ω–∏–µ service_role key –≤ Edge Function

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –í—Å–µ –µ—â–µ 401 –æ—à–∏–±–∫–∏

`execution id: null` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –î–û –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `service_role` key –≤–º–µ—Å—Ç–æ `anon` key –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.

---

## ‚úÖ –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ service_role key

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard

1. Supabase ‚Üí Settings ‚Üí **API**
2. –ù–∞–π–¥–∏—Ç–µ **service_role key** (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `eyJhbGc...` –∏–ª–∏ `sb_secret_...`)

**–í–∞—à service_role key:**
- `sb_secret_gUvwicd0QLe6PI-R-5rtcQ_vsm58rLJ`

---

## ‚úÖ –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ service_role key –∫–∞–∫ —Å–µ–∫—Ä–µ—Ç

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Secrets

1. Supabase ‚Üí Settings ‚Üí **Edge Functions** ‚Üí **Secrets**
2. –ù–∞–∂–º–∏—Ç–µ **"Add new secret"**

### 2. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç

- **Name**: `SUPABASE_SERVICE_ROLE_KEY`
- **Value**: `sb_secret_gUvwicd0QLe6PI-R-5rtcQ_vsm58rLJ`
- –ù–∞–∂–º–∏—Ç–µ **"Add secret"**

---

## ‚úÖ –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç–µ Edge Function

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Edge Function

1. Supabase ‚Üí Edge Functions ‚Üí `sync` ‚Üí **Code**

### 2. –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 117)

### 3. –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞:

```typescript
// –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Supabase
const supabaseUrl = Deno.env.get("SUPABASE_URL") || "https://zhchkxukgltknfbropqu.supabase.co";

// –ò—Å–ø–æ–ª—å–∑—É–µ–º service_role key –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (–æ–±—Ö–æ–¥–∏—Ç RLS –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç JWT)
// service_role key –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ —Å–µ–∫—Ä–µ—Ç SUPABASE_SERVICE_ROLE_KEY
const serviceRoleKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY") || 
                      Deno.env.get("SUPABASE_ANON_KEY") || 
                      "sb_publishable_m96BQEXNJw5_L_CI0kQkUg_0vdPodFS";

// –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç Supabase —Å service_role key
// –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ RLS –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
const supabaseClient = createClient(supabaseUrl, serviceRoleKey, {
  auth: {
    autoRefreshToken: false,
    persistSession: false
  }
});
```

### 4. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ

1. –ù–∞–∂–º–∏—Ç–µ **"Deploy"**
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

## ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Invocations ‚Äî –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å 200 OK (–Ω–µ 401)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã ‚Äî –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

- `service_role` key ‚Äî **—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á**, –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ –µ–≥–æ!
- –û–Ω –æ–±—Ö–æ–¥–∏—Ç RLS (Row Level Security), –ø–æ—ç—Ç–æ–º—É –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å–∫—É –≤ –∫–æ–¥–µ
- –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–∞–Ω–∞–ª –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

---

## ‚ùì –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ª–∏ —Å–µ–∫—Ä–µ—Ç `SUPABASE_SERVICE_ROLE_KEY`?
2. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ service_role key?
3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –ª–∏ –∫–æ–¥ Edge Function?
4. ‚úÖ –ó–∞–¥–µ–ø–ª–æ–µ–Ω–∞ –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è?
